@using TodoList.Models.Enums

<div class="card mb-4">
    <div class="card-body">
        <div class="row align-items-end">
            <div class="col-md-4 mb-2 mb-md-0">
                <label for="FilterStatus" class="form-label">Filter by Status</label>
                <select class="form-select" id="FilterStatus" value="@Filter"
                        @onchange="OnFilterChanged">
                    <option value="@FilterOption.All">All (@TotalCount)</option>
                    <option value="@FilterOption.Active">Active (@ActiveCount)</option>
                    <option value="@FilterOption.Completed">Completed (@CompletedCount)</option>
                </select>
            </div>
            <div class="col-md-4 mb-2 mb-md-0">
                <label for="SortBy" class="form-label">Sort by</label>
                <select class="form-select" id="SortBy" value="@Sort"
                        @onchange="OnSortChanged">
                    <option value="@SortOption.CreatedDate">Created Date</option>
                    <option value="@SortOption.Priority">Priority</option>
                    <option value="@SortOption.Status">Status</option>
                </select>
            </div>
            <div class="col-md-4">
                <div class="text-muted">
                    Showing <strong>@FilteredCount</strong> of <strong>@TotalCount</strong> items
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    [Parameter] public FilterOption Filter { get; set; }
    [Parameter] public SortOption Sort { get; set; }
    [Parameter] public int TotalCount { get; set; }
    [Parameter] public int ActiveCount { get; set; }
    [Parameter] public int CompletedCount { get; set; }
    [Parameter] public int FilteredCount { get; set; }
    [Parameter] public EventCallback<FilterOption> FilterChanged { get; set; }
    [Parameter] public EventCallback<SortOption> SortChanged { get; set; }

    private async Task OnFilterChanged(ChangeEventArgs e)
    {
        if (Enum.TryParse<FilterOption>(e.Value?.ToString(), out var filter))
            await FilterChanged.InvokeAsync(filter);
    }

    private async Task OnSortChanged(ChangeEventArgs e)
    {
        if (Enum.TryParse<SortOption>(e.Value?.ToString(), out var sort))
            await SortChanged.InvokeAsync(sort);
    }
}
